<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Download Template Excel - Quiz</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .container {
      max-width: 900px;
      width: 100%;
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 32px;
      text-align: center;
    }
    
    .subtitle {
      color: #666;
      margin-bottom: 40px;
      font-size: 16px;
      text-align: center;
    }
    
    .template-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .template-card {
      background: linear-gradient(135deg, #f6f8fb 0%, #ffffff 100%);
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      padding: 24px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .template-card:hover {
      border-color: #667eea;
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(102, 126, 234, 0.2);
    }
    
    .template-icon {
      font-size: 48px;
      margin-bottom: 12px;
    }
    
    .template-title {
      font-size: 18px;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
    }
    
    .template-desc {
      font-size: 14px;
      color: #666;
      line-height: 1.5;
    }
    
    .info-box {
      background: #f0f7ff;
      border-left: 4px solid #3b82f6;
      padding: 20px;
      margin-bottom: 30px;
      border-radius: 8px;
    }
    
    .info-box h3 {
      color: #1e40af;
      margin-bottom: 12px;
      font-size: 18px;
    }
    
    .info-box ul {
      margin-left: 20px;
      color: #374151;
      line-height: 1.8;
    }
    
    .info-box li {
      margin-bottom: 8px;
    }
    
    .info-box strong {
      color: #1e40af;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
      background: white;
      border-radius: 8px;
      overflow: hidden;
    }
    
    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }
    
    th {
      background: #f9fafb;
      font-weight: 600;
      color: #374151;
    }
    
    .example-section {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 20px;
      border-radius: 8px;
      margin-top: 30px;
    }
    
    .example-section h3 {
      color: #92400e;
      margin-bottom: 15px;
    }
    
    .btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 14px 32px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .btn:hover {
      transform: translateY(-2px);
    }
    
    .success-message {
      background: #dcfce7;
      border-left: 4px solid #16a34a;
      padding: 16px;
      border-radius: 8px;
      margin-top: 20px;
      display: none;
    }
    
    .success-message.show {
      display: block;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìä Download Template Excel</h1>
    <p class="subtitle">Pilih template yang sesuai dengan kebutuhan Anda</p>
    
    <div class="template-options">
      <div class="template-card" onclick="downloadEmptyTemplate()">
        <div class="template-icon">üìÑ</div>
        <div class="template-title">Template Kosong</div>
        <div class="template-desc">Template Excel kosong dengan header yang sudah disiapkan. Cocok untuk memulai dari nol.</div>
      </div>
      
      <div class="template-card" onclick="downloadSampleTemplate()">
        <div class="template-icon">üìù</div>
        <div class="template-title">Template + Contoh</div>
        <div class="template-desc">Template dengan 5 contoh soal lengkap. Cocok untuk memahami format yang benar.</div>
      </div>
      
      <div class="template-card" onclick="downloadFullTemplate()">
        <div class="template-icon">üìö</div>
        <div class="template-title">Template Lengkap</div>
        <div class="template-desc">Template dengan 20 contoh soal berbagai topik dan tingkat kesulitan.</div>
      </div>
    </div>
    
    <div class="info-box">
      <h3>üìã Format Kolom Excel:</h3>
      <table>
        <thead>
          <tr>
            <th>Kolom</th>
            <th>Nama Field</th>
            <th>Keterangan</th>
            <th>Wajib</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>A</strong></td>
            <td>ID Soal</td>
            <td>Format: topik-subtopik-001</td>
            <td>‚úÖ</td>
          </tr>
          <tr>
            <td><strong>B</strong></td>
            <td>Pertanyaan</td>
            <td>Teks pertanyaan lengkap</td>
            <td>‚úÖ</td>
          </tr>
          <tr>
            <td><strong>C</strong></td>
            <td>Pilihan A</td>
            <td>Opsi jawaban pertama</td>
            <td>‚úÖ</td>
          </tr>
          <tr>
            <td><strong>D</strong></td>
            <td>Pilihan B</td>
            <td>Opsi jawaban kedua</td>
            <td>‚úÖ</td>
          </tr>
          <tr>
            <td><strong>E</strong></td>
            <td>Pilihan C</td>
            <td>Opsi jawaban ketiga</td>
            <td>‚úÖ</td>
          </tr>
          <tr>
            <td><strong>F</strong></td>
            <td>Pilihan D</td>
            <td>Opsi jawaban keempat</td>
            <td>‚úÖ</td>
          </tr>
          <tr>
            <td><strong>G</strong></td>
            <td>Jawaban Benar</td>
            <td>A, B, C, D atau 0, 1, 2, 3</td>
            <td>‚úÖ</td>
          </tr>
          <tr>
            <td><strong>H</strong></td>
            <td>Tingkat Kesulitan</td>
            <td>mudah / sedang / sulit</td>
            <td>‚úÖ</td>
          </tr>
          <tr>
            <td><strong>I</strong></td>
            <td>Pembahasan</td>
            <td>Penjelasan jawaban lengkap</td>
            <td>‚úÖ</td>
          </tr>
          <tr>
            <td><strong>J</strong></td>
            <td>Tags</td>
            <td>Pisahkan dengan koma</td>
            <td>‚ùå</td>
          </tr>
          <tr>
            <td><strong>K</strong></td>
            <td>Referensi</td>
            <td>Sumber/dasar hukum</td>
            <td>‚ùå</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="example-section">
      <h3>üí° Tips Penting:</h3>
      <ul>
        <li><strong>ID Soal:</strong> Harus unik! Format: pbj-hps-001, hukum-pidana-001, dll.</li>
        <li><strong>Jawaban Benar:</strong> Bisa pakai huruf (A/B/C/D) atau angka (0/1/2/3)</li>
        <li><strong>Kesulitan:</strong> Harus lowercase: mudah, sedang, atau sulit</li>
        <li><strong>Pembahasan:</strong> Jelaskan mengapa jawaban benar dan mengapa pilihan lain salah</li>
        <li><strong>Tags:</strong> Gunakan untuk kategorisasi, contoh: HPS, PPK, Pengadaan</li>
        <li><strong>Jangan:</strong> Menggunakan tanda kutip ganda di dalam teks</li>
      </ul>
    </div>

    <div class="success-message" id="successMessage">
      <strong>‚úÖ Download Berhasil!</strong><br>
      File template telah didownload. Silakan buka dan isi sesuai format yang sudah ditentukan.
    </div>
  </div>

  <script>
    function downloadEmptyTemplate() {
      const wb = XLSX.utils.book_new();
      
      const headers = [
        'ID_Soal',
        'Pertanyaan',
        'Pilihan_A',
        'Pilihan_B',
        'Pilihan_C',
        'Pilihan_D',
        'Jawaban_Benar',
        'Tingkat_Kesulitan',
        'Pembahasan',
        'Tags',
        'Referensi'
      ];
      
      const ws = XLSX.utils.aoa_to_sheet([headers]);
      
      // Set column widths
      ws['!cols'] = [
        { wch: 15 },  // ID
        { wch: 50 },  // Pertanyaan
        { wch: 30 },  // A
        { wch: 30 },  // B
        { wch: 30 },  // C
        { wch: 30 },  // D
        { wch: 15 },  // Jawaban
        { wch: 20 },  // Kesulitan
        { wch: 60 },  // Pembahasan
        { wch: 30 },  // Tags
        { wch: 30 }   // Referensi
      ];
      
      XLSX.utils.book_append_sheet(wb, ws, 'Soal Quiz');
      XLSX.writeFile(wb, 'template-quiz-kosong.xlsx');
      
      showSuccess();
    }
    
    function downloadSampleTemplate() {
      const wb = XLSX.utils.book_new();
      
      const data = [
        [
          'ID_Soal',
          'Pertanyaan',
          'Pilihan_A',
          'Pilihan_B',
          'Pilihan_C',
          'Pilihan_D',
          'Jawaban_Benar',
          'Tingkat_Kesulitan',
          'Pembahasan',
          'Tags',
          'Referensi'
        ],
        [
          'pbj-hps-001',
          'Apa yang dimaksud dengan HPS dalam pengadaan barang/jasa?',
          'Harga Penawaran Supplier',
          'Harga Perkiraan Sendiri',
          'Harga Pasar Standar',
          'Harga Pemerintah Setempat',
          'B',
          'mudah',
          'HPS (Harga Perkiraan Sendiri) adalah perkiraan harga barang/jasa yang ditetapkan oleh PPK berdasarkan survei harga pasar setempat.',
          'HPS, PPK, Pengadaan',
          'Perpres 12/2021 Pasal 1 Ayat 23'
        ],
        [
          'pbj-hps-002',
          'Siapa yang berwenang menetapkan HPS?',
          'Panitia Pengadaan',
          'PPK (Pejabat Pembuat Komitmen)',
          'Direktur Perusahaan',
          'Bendahara',
          '1',
          'mudah',
          'PPK (Pejabat Pembuat Komitmen) adalah pihak yang berwenang menetapkan HPS. PPK harus melakukan survei harga pasar sebelum menetapkan HPS.',
          'PPK, HPS, Kewenangan',
          'Perpres 12/2021 Pasal 27'
        ],
        [
          'pbj-kontrak-001',
          'Apa yang dimaksud dengan kontrak lump sum?',
          'Kontrak dengan harga satuan',
          'Kontrak dengan harga pasti dan tetap',
          'Kontrak dengan harga yang bisa berubah',
          'Kontrak tanpa jaminan',
          'B',
          'sedang',
          'Kontrak lump sum adalah kontrak dengan harga pasti dan tetap untuk menyelesaikan seluruh pekerjaan. Harga tidak akan berubah kecuali ada addendum.',
          'Kontrak, Lump Sum, Pengadaan',
          'Perpres 12/2021'
        ],
        [
          'hukum-pidana-001',
          'Apa yang dimaksud dengan delik dalam hukum pidana?',
          'Perbuatan yang dilarang oleh undang-undang',
          'Hukuman penjara',
          'Proses persidangan',
          'Surat dakwaan',
          'A',
          'mudah',
          'Delik adalah perbuatan yang dilarang oleh undang-undang dan diancam dengan pidana bagi siapa yang melakukannya.',
          'Delik, Hukum Pidana, Tindak Pidana',
          'KUHP'
        ],
        [
          'hukum-perdata-001',
          'Apa yang dimaksud dengan wanprestasi?',
          'Prestasi kerja yang baik',
          'Tidak memenuhi kewajiban dalam perjanjian',
          'Pembatalan kontrak sepihak',
          'Ganti rugi akibat perbuatan melawan hukum',
          'B',
          'sulit',
          'Wanprestasi adalah kondisi dimana salah satu pihak tidak memenuhi kewajibannya dalam perjanjian, baik tidak melakukan, terlambat, atau melakukan tidak sesuai perjanjian.',
          'Wanprestasi, Perjanjian, Hukum Perdata',
          'KUHPerdata Pasal 1243'
        ]
      ];
      
      const ws = XLSX.utils.aoa_to_sheet(data);
      
      ws['!cols'] = [
        { wch: 18 },  // ID
        { wch: 55 },  // Pertanyaan
        { wch: 32 },  // A
        { wch: 32 },  // B
        { wch: 32 },  // C
        { wch: 32 },  // D
        { wch: 15 },  // Jawaban
        { wch: 20 },  // Kesulitan
        { wch: 70 },  // Pembahasan
        { wch: 35 },  // Tags
        { wch: 30 }   // Referensi
      ];
      
      XLSX.utils.book_append_sheet(wb, ws, 'Soal Quiz');
      XLSX.writeFile(wb, 'template-quiz-contoh.xlsx');
      
      showSuccess();
    }
    
    function downloadFullTemplate() {
      const wb = XLSX.utils.book_new();
      
      const data = [
        [
          'ID_Soal',
          'Pertanyaan',
          'Pilihan_A',
          'Pilihan_B',
          'Pilihan_C',
          'Pilihan_D',
          'Jawaban_Benar',
          'Tingkat_Kesulitan',
          'Pembahasan',
          'Tags',
          'Referensi'
        ]
      ];
      
      // PBJ - HPS (5 soal)
      const pbj_hps = [
        ['pbj-hps-001', 'Apa yang dimaksud dengan HPS dalam pengadaan barang/jasa?', 'Harga Penawaran Supplier', 'Harga Perkiraan Sendiri', 'Harga Pasar Standar', 'Harga Pemerintah Setempat', 'B', 'mudah', 'HPS (Harga Perkiraan Sendiri) adalah perkiraan harga barang/jasa yang ditetapkan oleh PPK berdasarkan survei harga pasar.', 'HPS, PPK', 'Perpres 12/2021'],
        ['pbj-hps-002', 'Siapa yang berwenang menetapkan HPS?', 'Panitia Pengadaan', 'PPK', 'Direktur', 'Bendahara', '1', 'mudah', 'PPK adalah pihak yang berwenang menetapkan HPS.', 'PPK, HPS', 'Perpres 12/2021'],
        ['pbj-hps-003', 'Berapa toleransi harga penawaran terhadap HPS?', '60%-90%', '70%-100%', '80%-110%', '90%-120%', 'C', 'sedang', 'Harga penawaran wajar adalah 80%-110% dari HPS.', 'HPS, Penawaran', 'Perpres 12/2021'],
        ['pbj-hps-004', 'Apa yang dilakukan jika penawaran melebihi pagu?', 'Gugurkan semua', 'Negosiasi', 'Sesuaikan HPS dan ulang', 'Tambah pagu', 'C', 'sulit', 'Harus menyesuaikan HPS dan mengulang lelang.', 'HPS, Lelang', 'Perpres 12/2021'],
        ['pbj-hps-005', 'Dokumen apa yang dijadikan dasar HPS?', 'Penawaran vendor', 'Survei harga pasar', 'Anggaran tahun lalu', 'Perkiraan sendiri', 'B', 'mudah', 'HPS disusun berdasarkan survei harga pasar setempat.', 'HPS, Survei', 'Perpres 12/2021']
      ];
      
      // PBJ - Kontrak (5 soal)
      const pbj_kontrak = [
        ['pbj-kontrak-001', 'Apa itu kontrak lump sum?', 'Harga satuan', 'Harga pasti tetap', 'Harga berubah', 'Tanpa jaminan', 'B', 'mudah', 'Kontrak lump sum adalah kontrak dengan harga pasti dan tetap.', 'Kontrak, Lump Sum', 'Perpres 12/2021'],
        ['pbj-kontrak-002', 'Berapa denda maksimal keterlambatan?', '3%', '5%', '7%', '10%', 'B', 'sedang', 'Denda maksimal adalah 5% dari nilai kontrak.', 'Kontrak, Denda', 'Perpres 12/2021'],
        ['pbj-kontrak-003', 'Apa fungsi jaminan pelaksanaan?', 'Bayar uang muka', 'Jamin kesungguhan', 'Pengganti termin', 'Biaya admin', 'B', 'mudah', 'Jaminan pelaksanaan menjamin kesungguhan penyedia.', 'Jaminan, Kontrak', 'Perpres 12/2021'],
        ['pbj-kontrak-004', 'Kapan force majeure dapat diklaim?', 'Kerugian penyedia', 'Kejadian luar biasa', 'Harga naik', 'Penyedia mundur', 'B', 'sulit', 'Force majeure untuk kejadian luar biasa di luar kendali.', 'Force Majeure', 'Perpres 12/2021'],
        ['pbj-kontrak-005', 'Apa syarat perubahan kontrak?', 'Persetujuan penyedia', 'Addendum resmi', 'Email saja', 'Lisan', 'B', 'sedang', 'Perubahan kontrak harus melalui addendum resmi.', 'Kontrak, Addendum', 'Perpres 12/2021']
      ];
      
      // Hukum - Pidana (5 soal)
      const hukum_pidana = [
        ['hukum-pidana-001', 'Apa itu delik dalam hukum pidana?', 'Perbuatan dilarang UU', 'Hukuman penjara', 'Proses sidang', 'Surat dakwaan', 'A', 'mudah', 'Delik adalah perbuatan yang dilarang undang-undang.', 'Delik, Pidana', 'KUHP'],
        ['hukum-pidana-002', 'Berapa daluwarsa penuntutan pidana >3 tahun?', '6 tahun', '12 tahun', '18 tahun', 'Tidak ada', 'B', 'sulit', 'Daluwarsa penuntutan adalah 12 tahun.', 'Daluwarsa, Pidana', 'KUHP Pasal 78'],
        ['hukum-pidana-003', 'Apa asas hukum pidana di Indonesia?', 'Retroaktif', 'Legalitas', 'Keadilan', 'Kemanfaatan', 'B', 'sedang', 'Asas legalitas: tidak ada pidana tanpa UU.', 'Asas, Legalitas', 'KUHP Pasal 1'],
        ['hukum-pidana-004', 'Apa sanksi percobaan kejahatan?', 'Sama dengan selesai', '2/3 dari maksimal', '1/2 dari maksimal', 'Bebas', 'B', 'sedang', 'Percobaan diancam 2/3 dari maksimal.', 'Percobaan, Sanksi', 'KUHP Pasal 53'],
        ['hukum-pidana-005', 'Siapa yang bisa jadi saksi mahkota?', 'Terdakwa lain', 'Korban', 'Polisi', 'Jaksa', 'A', 'sulit', 'Saksi mahkota adalah terdakwa yang dijadikan saksi.', 'Saksi, Mahkota', 'KUHAP']
      ];
      
      // Hukum - Perdata (5 soal)
      const hukum_perdata = [
        ['hukum-perdata-001', 'Apa itu wanprestasi?', 'Prestasi baik', 'Tidak penuhi kewajiban', 'Batal sepihak', 'Ganti rugi PMH', 'B', 'mudah', 'Wanprestasi adalah tidak memenuhi kewajiban perjanjian.', 'Wanprestasi, Perjanjian', 'KUHPerdata 1243'],
        ['hukum-perdata-002', 'Beda jual beli dan sewa?', 'Tidak ada', 'Jual beli ada perpindahan hak', 'Jual beli lebih mahal', 'Sewa hanya barang gerak', 'B', 'sedang', 'Jual beli ada perpindahan hak milik, sewa hanya hak pakai.', 'Jual Beli, Sewa', 'KUHPerdata'],
        ['hukum-perdata-003', 'Syarat sah perjanjian ada berapa?', '2', '3', '4', '5', 'C', 'mudah', 'Ada 4 syarat: sepakat, cakap, hal tertentu, kausa halal.', 'Perjanjian, Syarat Sah', 'KUHPerdata 1320'],
        ['hukum-perdata-004', 'Apa akibat perjanjian tanpa kausa halal?', 'Tetap sah', 'Batal demi hukum', 'Dapat dibatalkan', 'Ditangguhkan', 'B', 'sedang', 'Perjanjian tanpa kausa halal batal demi hukum.', 'Perjanjian, Kausa', 'KUHPerdata 1335'],
        ['hukum-perdata-005', 'Kapan somasi wajib diberikan?', 'Selalu', 'Tergantung perjanjian', 'Tidak pernah', 'Hanya pidana', 'B', 'sulit', 'Somasi wajib kecuali ditentukan lain dalam perjanjian.', 'Somasi, Wanprestasi', 'KUHPerdata 1238']
      ];
      
      // Combine all data
      data.push(...pbj_hps, ...pbj_kontrak, ...hukum_pidana, ...hukum_perdata);
      
      const ws = XLSX.utils.aoa_to_sheet(data);
      
      ws['!cols'] = [
        { wch: 18 },
        { wch: 55 },
        { wch: 30 },
        { wch: 30 },
        { wch: 30 },
        { wch: 30 },
        { wch: 15 },
        { wch: 18 },
        { wch: 70 },
        { wch: 35 },
        { wch: 25 }
      ];
      
      XLSX.utils.book_append_sheet(wb, ws, 'Soal Quiz');
      XLSX.writeFile(wb, 'template-quiz-lengkap.xlsx');
      
      showSuccess();
    }
    
    function showSuccess() {
      const msg = document.getElementById('successMessage');
      msg.classList.add('show');
      setTimeout(() => {
        msg.classList.remove('show');
      }, 5000);
    }
  </script>
</body>
</html>
